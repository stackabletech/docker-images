# Stackable Docker Images

This repository contains Dockerfiles and scripts to build base images for use within Stackable.

<!-- start:badges: autogenerated by .scripts/update_readme_badges.sh -->
| | | | |
| -: | -: | -: | -: |
| [![Build Airflow]][build_airflow.yaml] | [![Build Druid]][build_druid.yaml] | [![Build Hadoop]][build_hadoop.yaml] | [![Build HBase]][build_hbase.yaml] |
| [![Build Hive]][build_hive.yaml] | [![Build Java Base]][build_java-base.yaml] | [![Build Java Development]][build_java-devel.yaml] | [![Build Kafka Testing Tools]][build_kafka-testing-tools.yaml] |
| [![Build Kafka]][build_kafka.yaml] | [![Build Krb5]][build_krb5.yaml] | [![Build NiFi]][build_nifi.yaml] | [![Build Omid]][build_omid.yaml] |
| [![Build OPA]][build_opa.yaml] | [![Build OpenSearch Dashboards]][build_opensearch_dashboards.yaml] | [![Build OpenSearch]][build_opensearch.yaml] | [![Build Spark Connect Client]][build_spark-connect-client.yaml] |
| [![Build Spark K8s]][build_spark-k8s.yaml] | [![Build Stackable Base]][build_stackable-base.yaml] | [![Build Superset]][build_superset.yaml] | [![Build Testing Tools]][build_testing-tools.yaml] |
| [![Build Tools]][build_tools.yaml] | [![Build Trino CLI]][build_trino-cli.yaml] | [![Build Trino]][build_trino.yaml] | [![Build Vector]][build_vector.yaml] |
| [![Build ZooKeeper]][build_zookeeper.yaml] | | | |
<!-- end:badges -->

## Prerequisites

* [boil](./rust/boil//README.md) (`cargo boil`)
* Docker including the [`buildx` plugin](https://github.com/docker/buildx)
* Optional: [OpenShift preflight tool](https://github.com/redhat-openshift-ecosystem/openshift-preflight) to verify an image for OpenShift

## Build Images

Images are published to the `oci.stackable.tech` registry under the `sdp` organization by default.

### Build images locally

Consult the [boil README](./rust/boil//README.md) which contains a broad selection of different commands to build images locally.

### Build images via GitHub Actions

There are individual GHA workflows (one for each image) which use a
[reusable workflow](.github/workflows/reusable_build_image.yaml) to build all specified versions for
both `amd64` and `arm64`. The workflow is triggered

* by pushes to `main` to produce `0.0.0-dev` versions of the images,
* by a regular schedule to rebuild `0.0.0-dev` versions of the images to avoid staleness,
* by tag pushes to produce (release candidate) images for a particular SDP release,
* and by manual workflow dispatches.

## Patch Images

Images are patched using `patchable`. Consult the [patchable README](./rust/patchable/README.md) which contains a detailed usage guide.

## Verify Images

To verify if a container image is compatible with OpenShift, run the following `preflight` command:

```sh
preflight check container oci.stackable.tech/sdp/<IMAGE>:<VERSION>-stackable<RELEASE_VERSION> --platform amd64
```

<!-- start:links: autogenerated by .scripts/update_readme_badges.sh -->
[Build Airflow]: https://github.com/stackabletech/docker-images/actions/workflows/build_airflow.yaml/badge.svg
[build_airflow.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_airflow.yaml
[Build Druid]: https://github.com/stackabletech/docker-images/actions/workflows/build_druid.yaml/badge.svg
[build_druid.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_druid.yaml
[Build Hadoop]: https://github.com/stackabletech/docker-images/actions/workflows/build_hadoop.yaml/badge.svg
[build_hadoop.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_hadoop.yaml
[Build HBase]: https://github.com/stackabletech/docker-images/actions/workflows/build_hbase.yaml/badge.svg
[build_hbase.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_hbase.yaml
[Build Hive]: https://github.com/stackabletech/docker-images/actions/workflows/build_hive.yaml/badge.svg
[build_hive.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_hive.yaml
[Build Java Base]: https://github.com/stackabletech/docker-images/actions/workflows/build_java-base.yaml/badge.svg
[build_java-base.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_java-base.yaml
[Build Java Development]: https://github.com/stackabletech/docker-images/actions/workflows/build_java-devel.yaml/badge.svg
[build_java-devel.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_java-devel.yaml
[Build Kafka Testing Tools]: https://github.com/stackabletech/docker-images/actions/workflows/build_kafka-testing-tools.yaml/badge.svg
[build_kafka-testing-tools.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_kafka-testing-tools.yaml
[Build Kafka]: https://github.com/stackabletech/docker-images/actions/workflows/build_kafka.yaml/badge.svg
[build_kafka.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_kafka.yaml
[Build Krb5]: https://github.com/stackabletech/docker-images/actions/workflows/build_krb5.yaml/badge.svg
[build_krb5.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_krb5.yaml
[Build NiFi]: https://github.com/stackabletech/docker-images/actions/workflows/build_nifi.yaml/badge.svg
[build_nifi.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_nifi.yaml
[Build Omid]: https://github.com/stackabletech/docker-images/actions/workflows/build_omid.yaml/badge.svg
[build_omid.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_omid.yaml
[Build OPA]: https://github.com/stackabletech/docker-images/actions/workflows/build_opa.yaml/badge.svg
[build_opa.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_opa.yaml
[Build OpenSearch Dashboards]: https://github.com/stackabletech/docker-images/actions/workflows/build_opensearch_dashboards.yaml/badge.svg
[build_opensearch_dashboards.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_opensearch_dashboards.yaml
[Build OpenSearch]: https://github.com/stackabletech/docker-images/actions/workflows/build_opensearch.yaml/badge.svg
[build_opensearch.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_opensearch.yaml
[Build Spark Connect Client]: https://github.com/stackabletech/docker-images/actions/workflows/build_spark-connect-client.yaml/badge.svg
[build_spark-connect-client.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_spark-connect-client.yaml
[Build Spark K8s]: https://github.com/stackabletech/docker-images/actions/workflows/build_spark-k8s.yaml/badge.svg
[build_spark-k8s.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_spark-k8s.yaml
[Build Stackable Base]: https://github.com/stackabletech/docker-images/actions/workflows/build_stackable-base.yaml/badge.svg
[build_stackable-base.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_stackable-base.yaml
[Build Superset]: https://github.com/stackabletech/docker-images/actions/workflows/build_superset.yaml/badge.svg
[build_superset.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_superset.yaml
[Build Testing Tools]: https://github.com/stackabletech/docker-images/actions/workflows/build_testing-tools.yaml/badge.svg
[build_testing-tools.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_testing-tools.yaml
[Build Tools]: https://github.com/stackabletech/docker-images/actions/workflows/build_tools.yaml/badge.svg
[build_tools.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_tools.yaml
[Build Trino CLI]: https://github.com/stackabletech/docker-images/actions/workflows/build_trino-cli.yaml/badge.svg
[build_trino-cli.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_trino-cli.yaml
[Build Trino]: https://github.com/stackabletech/docker-images/actions/workflows/build_trino.yaml/badge.svg
[build_trino.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_trino.yaml
[Build Vector]: https://github.com/stackabletech/docker-images/actions/workflows/build_vector.yaml/badge.svg
[build_vector.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_vector.yaml
[Build ZooKeeper]: https://github.com/stackabletech/docker-images/actions/workflows/build_zookeeper.yaml/badge.svg
[build_zookeeper.yaml]: https://github.com/stackabletech/docker-images/actions/workflows/build_zookeeper.yaml
<!-- end:links -->
