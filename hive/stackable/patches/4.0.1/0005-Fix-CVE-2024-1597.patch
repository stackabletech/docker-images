From 134b9e22475b3ae59eabbc0bf5c188912dc2393b Mon Sep 17 00:00:00 2001
From: Nick Larsen <nick.larsen@stackable.tech>
Date: Thu, 15 May 2025 14:14:28 +0200
Subject: Fix CVE-2024-1597

See https://github.com/stackabletech/vulnerabilities/issues/681

pgjdbc, the PostgreSQL JDBC Driver, allows attacker to inject SQL if using
PreferQueryMode=SIMPLE. Note this is not the default. In the default mode there
is no vulnerability. A placeholder for a numeric value must be immediately
preceded by a minus. There must be a second placeholder for a string value after
the first placeholder; both must be on the same line. By constructing a matching
string payload, the attacker can inject SQL to alter the query,bypassing the
protections that parameterized queries bring against SQL Injection attacks.
Versions before 42.7.2, 42.6.1, 42.5.5, 42.4.4, 42.3.9, and 42.2.28 are
affected.
---
 pom.xml                      | 2 +-
 standalone-metastore/pom.xml | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/pom.xml b/pom.xml
index 1898adeebe..89cf93ed37 100644
--- a/pom.xml
+++ b/pom.xml
@@ -179,7 +179,7 @@
     <mariadb.version>2.5.0</mariadb.version>
     <mssql.version>6.2.1.jre8</mssql.version>
     <mysql.version>8.0.31</mysql.version>
-    <postgres.version>42.5.1</postgres.version>
+    <postgres.version>42.5.6</postgres.version>
     <oracle.version>21.3.0.0</oracle.version>
     <opencsv.version>2.3</opencsv.version>
     <orc.version>1.8.5</orc.version>
diff --git a/standalone-metastore/pom.xml b/standalone-metastore/pom.xml
index 599ad33ed0..17dfe063e8 100644
--- a/standalone-metastore/pom.xml
+++ b/standalone-metastore/pom.xml
@@ -73,7 +73,7 @@
     <mariadb.version>2.5.0</mariadb.version>
     <mssql.version>6.2.1.jre8</mssql.version>
     <mysql.version>8.0.31</mysql.version>
-    <postgres.version>42.5.1</postgres.version>
+    <postgres.version>42.5.6</postgres.version>
     <oracle.version>21.3.0.0</oracle.version>
     <dropwizard-metrics-hadoop-metrics2-reporter.version>0.1.2
     </dropwizard-metrics-hadoop-metrics2-reporter.version>
